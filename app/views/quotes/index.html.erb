<h1>View Quotes for this listing</h1>

<%@amount_of_user_quotes = 0%>

<%if current_user.user_type == "designer"%>
    <% @quotes.each do |quote| %>
        <%if quote.listing_id == params[:listing].to_i%>

            <!-- if user is a designer, show all quotes for this listing -->
        <div class="card">
            <p>Quote Id: <%= quote.id %></p>
            <p>Printer Id: <%= quote.printer_id %></p>
            <p>Listing Id: <%= quote.listing_id %></p>
            <p>Total Price: $<%= number_with_precision(quote.total_price, precision: 2) %></p>
            <p>Job Size (cubic cm): <%= quote.job_size %></p>
            <p>Turnaround Time: <%= quote.turnaround_time %></p>
            <%= link_to "Edit", edit_quote_path(quote.id) %>
            <%= link_to "Show",quote_path(quote.id) %>
            <%@amount_of_user_quotes += 1%>
        </div>

        <%end%>
    <% end %>


<%else%>

    <% @quotes.each do |quote| %>
        <%if quote.listing_id == params[:listing].to_i%>

            <%if Printer.find(quote.printer_id).user_id == current_user.id%>
             <!-- if user is a printer, show all quotes they have made for this listing -->
        <div class="card">
            <p>Quote Id: <%= quote.id %></p>
            <p>Printer Id: <%= quote.printer_id %></p>
            <p>Listing Id: <%= quote.listing_id %></p>
            <p>Total Price: $<%= number_with_precision(quote.total_price, precision: 2) %></p>
            <p>Job Size (cubic cm): <%= quote.job_size %></p>
            <p>Turnaround Time: <%= quote.turnaround_time %></p>
            <%= link_to "Edit", edit_quote_path(quote.id) %>
            <%= link_to "Show",quote_path(quote.id) %>
            <%@amount_of_user_quotes += 1%>
        </div>
            <%end%>


         

        <%end%>
    <% end %>



<%end%>

<p> <%=@amount_of_user_quotes%> </p>
<%if @amount_of_user_quotes == 0%>

    <%if current_user.user_type == "designer"%>

        <p>There are no quotes attached to this listing.</p>

    <%else%>

        <p> You have not made any quotes for this listing. </p>
        <%=link_to "Create Quote", new_quote_path(listing: params[:listing])%>


    <%end%>

    <%= link_to "Back to listings", listings_path %>

<%end%>

