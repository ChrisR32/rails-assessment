<main class="container-fluid">
    <div class="row">
    
        <%= render "pages/sidebar" %>

        <!-- start of main content -->
        <div class="col-sm-9">

            <h1 class="h1 page-header"> Job id. <%= @job.id %></h1>


            <div class="row card">
                <div class="col-md-6">
                    <% if @job.status == false %>
                        <p class="active">Status: Active</p>
                    <% else %>
                        <p class="completed">Status: Completed</p>
                    <% end %>
                    <p>Listing id. <%= @job.listing_id %></p>
                    <p>Designer Name: <%= "#{@job.listing.user.first_name} #{@job.listing.user.last_name}" %></p>
                    <p>Description: <%= @job.listing.description %></p>
                    <p>Total Price: $<%= number_with_precision(@job.quote.total_price, precision: 2) %>
                    <p>Job Size (cubic cm): <%= @job.quote.job_size %></p>
                    <p>Turnaround Time: <%= @job.quote.turnaround_time %></p>
                    <p>Created at: <%= @job.created_at.to_time.strftime('%A, %d %b %Y %H:%M') %></p>
                    <p>Completed at: 
                        <% if @job.status %>
                        <%= @job.updated_at.to_time.strftime('%A, %d %b %Y %H:%M') %> 
                        <% end %>
                    </p>
                    <p>Quote id: <%= @job.quote_id %></p>
                    <p>Printer Name: <%= "#{@job.printer.user.first_name} #{@job.printer.user.last_name}" %></p>
                    <p>ABN: <%= @job.printer.abn %></p>
                    <p>Printer Model: <%= @job.printer.printer_model %></p>
                </div>

                <!-- Printer can click on Completed Job button to show job as completed
                    Change status column to True
                    Add timestamp to completed_at column
                -->
                <div class="col-md-3">
                    <% if current_user.user_type == "printer" && @job.status == false %>
                        <%= form_for :job do |form| %>
                            <%= form.hidden_field :status, value: true %>
                            <%= form.hidden_field :completed_at, value: Time.now %>
                            <%= form.submit 'Mark Job As Complete', class: 'button_link' %>
                        <% end %>
                    <% end %>
                </div>
                
                
            </div>
            <div class="col-md-3 hidden-xs">
                <%= link_to 'Back to Jobs', jobs_path, class: "button_link" %>
            </div>
            <div class="col-md-12 hidden-sm-up">
                <%= link_to 'Back to Jobs', jobs_path, class: "button_link" %>
            </div>
            <div class="col-md-12 hidden-sm-up">
                <%= link_to 'Back to Dashboard', dashboard_path, class: "button_link" %>
            </div>
            <div class="col-md-12 hidden-sm-up">
                <%= link_to 'Back to My Quotes', my_quotes_path, class: "button_link" %>
            </div>
        </div>
        <!-- end of main content -->
    </div>
</main>